# arubaos-switch

Superagent utilities for interacting with the ArubaOS-Switch REST API

## Features

-   Based on [superagent.Agent](https://visionmedia.github.io/superagent/#agents-for-global-state), a simple & robust http client class with in-built cookie handling.
-   Simple & flexible API with minimal moving parts.
-   Able to work with environment variables, by default.
-   Super-lightweight package.

## Getting Started

```javascript
import { useClient } from 'arubaos-switch';

function requestGetSystem(client) {
  return client
    .get('/system');
}

const response = await useClient(requestGetSystem);
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [createClient](#createclient)
    -   [Parameters](#parameters)
    -   [Examples](#examples)
-   [useClient](#useclient)
    -   [Parameters](#parameters-1)
    -   [Examples](#examples-1)

### createClient

Request URLs are prepended with the appropriate URL base,
so only REST API endpoints are required.

#### Parameters

-   `host` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Switch IP address (typically) (optional, default `process.env.ARUBA_OS_SWITCH_HOST!`)
-   `version` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ArubaOS-Switch REST API version (optional, default `process.env.ARUBA_OS_SWITCH_VERSION||'v1'`)

#### Examples

```javascript
const client = createClient();
```

Returns **any** ArubaOS-Switch REST API client

### useClient

#### Parameters

-   `fn` **function (client: any): [Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;T>** Function whose only parameter is `client`
-   `client` **any** ArubaOS-Switch REST API client (optional, default `createClient()`)
-   `userName` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)**  (optional, default `process.env.ARUBA_OS_SWITCH_USERNAME||'manager'`)
-   `password` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Switch password (optional, default `process.env.ARUBA_OS_SWITCH_PASSWORD||''`)
-   `username`  Switch username

#### Examples

First, define a function which accepts & uses the `client` paramter


```javascript
function requestGetSystem(client) {
  return client
    .get('/system');
}
```

Then, use the `useClient` function which returns the resolved value of `fn`


```javascript
const response = await useClient(requestGetSystem);
```

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;T>** Promise that resolves to the return value of `fn`

## Testing

Tests are performed on an actual Aruba switch whose credentials are defined by environment variables.
These can be fed either via the command line or a `.env` file at the root of this package.

```bash
$ npm test
```
